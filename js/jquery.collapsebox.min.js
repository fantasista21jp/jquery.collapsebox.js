(function(d){d.fn.collapsebox=function(a){function u(){var c={};e=b.container.height();g=b.handle.outerHeight(!0);e==g&&(e=b.container.css({height:"",overflow:""}).height(),b.container.css({height:g,overflow:"hidden"}));c.height=e+"px";if(!1===h)c[a.fulcrumX]=a.spaceX,c[a.fulcrumY]=a.spaceY,c.position="fixed";else{q();if("right"==a.fulcrumX||"bottom"==a.fulcrumY){var f;d(window).resize(function(){f&&clearTimeout(f);f=setTimeout(function(){q()},0)})}c.position="absolute"}c.zIndex=a.zIndex;1!==a.opacity&&
(c.opacity=a.opacity);b.container.css(c)}function q(){var c=d(window),f=a.spaceX,l=a.spaceY;"right"==a.fulcrumX&&(f=c.width()-a.spaceX-b.container.outerWidth(!1));"bottom"==a.fulcrumY&&(l=c.height()-a.spaceY-b.container.outerHeight(!1));b.container.get(0).style.setExpression("left","eval("+f+"+(document.body.scrollLeft||document.documentElement.scrollLeft))");b.container.get(0).style.setExpression("top","eval("+l+"+(document.body.scrollTop||document.documentElement.scrollTop))")}function v(){var c;
c=!0===w&&!1===x()?{start:function(a,b){d(this).css("position","absolute")},stop:function(a,b){var c=r();c.position="fixed";d(this).css(c)},containment:"html",refreshPositions:!0,handle:b.handle,zIndex:a.zIndex+1,cursor:"move",scroll:!1}:!0===h?{stop:function(c,l){var k=d(window),e=b.container.offset();"right"==a.fulcrumX&&(a.spaceX=k.width()-e.left+k.scrollLeft()-b.container.outerWidth(!1));"bottom"==a.fulcrumY&&(a.spaceY=k.height()-e.top+k.scrollTop()-b.container.outerHeight(!1));b.container.get(0).style.setExpression("left",
"eval("+(e.left-k.scrollLeft())+"+(document.body.scrollLeft||document.documentElement.scrollLeft))");b.container.get(0).style.setExpression("top","eval("+(e.top-k.scrollTop())+"+(document.body.scrollTop||document.documentElement.scrollTop))")},handle:b.handle,zIndex:a.zIndex+1,cursor:"move",scroll:!1}:{stop:function(a,b){var c=r();c.position="fixed";d(this).css(c)},handle:b.handle,zIndex:a.zIndex+1,cursor:"move",scroll:!1};b.handle.css("cursor","move");b.container.draggable(c)}function x(){var a=
d.ui.version.split(".");return 0<parseInt(a[0])&&7<parseInt(a[1])?!0:!1}function r(){var c=d(window),f=b.container.offset(),e={};"left"==a.fulcrumX?(e[a.fulcrumX]=f.left-c.scrollLeft(),e.right="auto"):(e[a.fulcrumX]=c.width()+c.scrollLeft()-f.left-b.container.outerWidth(!1),e.left="auto");"top"==a.fulcrumY?(e[a.fulcrumY]=f.top-c.scrollTop(),e.bottom="auto"):(e[a.fulcrumY]=c.height()+c.scrollTop()-f.top-b.container.outerHeight(!1),e.top="auto");return e}function y(){b.button.unbind(a.action).bind(a.action,
function(){m()&&("open"==n()?s():z())})}function z(){if(m()&&"open"!=n()){t();d.isFunction(a.openBeforeFunc)&&a.openBeforeFunc(b.container,b.handle,b.button);if(!1===h){var c="auto",f="auto";"top"==a.fulcrumY?c=b.container.css("top"):(f=parseInt(b.container.css("bottom"))-(e-g),b.container.css({top:b.container.offset().top-d(window).scrollTop(),bottom:"auto"}))}b.button.removeClass(a.openButtonClass+" "+a.closeButtonClass).addClass(a.openButtonClass);b.container.animate({height:e},a.speed,a.easing,
function(){!1===h&&b.container.css({height:e+"px",overflow:"",top:c,bottom:f});d.isFunction(a.openAfterFunc)&&a.openAfterFunc(b.container,b.handle,b.button);p()})}}function s(){if(m()){"close"==n()&&s();t();d.isFunction(a.closeBeforeFunc)&&a.closeBeforeFunc(b.container,b.handle,b.button);if(!1===h){var c="auto",f="auto";"top"==a.fulcrumY?c=b.container.css("top"):(f=parseInt(b.container.css("bottom"))+(e-g),b.container.css({top:b.container.offset().top-d(window).scrollTop(),bottom:"auto"}))}b.button.removeClass(a.openButtonClass+
" "+a.closeButtonClass).addClass(a.closeButtonClass);b.container.css({overflow:"hidden"}).animate({height:g},a.speed,a.easing,function(){!1===h&&b.container.css({top:c,bottom:f});d.isFunction(a.closeAfterFunc)&&a.closeAfterFunc(b.container,b.handle,b.button);p()})}}function m(){return b.button.hasClass("collapsebox-ready")}function p(){b.button.removeClass("collapsebox-ready").addClass("collapsebox-ready")}function t(){b.button.removeClass("collapsebox-ready")}function n(){return b.button.hasClass(a.closeButtonClass)?
"close":"open"}var A={fulcrumX:"left",spaceX:0,fulcrumY:"top",spaceY:0,zIndex:9999,opacity:1,handle:null,button:null,action:"click",speed:300,easing:"swing",openButtonClass:"collapsebox-open",closeButtonClass:"collapsebox-close",openBeforeFunc:null,openAfterFunc:null,closeBeforeFunc:null,closeAfterFunc:null,draggable:!1};if(a&&(a=d.extend(A,a),!("left"!=a.fulcrumX&&"right"!=a.fulcrumX||"top"!=a.fulcrumY&&"bottom"!=a.fulcrumY||"number"!=typeof a.spaceX||"number"!=typeof a.spaceY||!a.button&&!a.handle))){var b=
{container:this,button:a.button.nodeType?a.button:d(a.button,this),handle:a.handle.nodeType?a.handle:d(a.handle,this),parent:d(this.parent().get(0))};if(b.container.length&&b.button.length&&b.handle.length&&b.parent.length&&"BODY"==b.parent.context.nodeName.toUpperCase()){var e=0,g=0,h=!d.support.style&&"undefined"===typeof document.documentElement.style.maxHeight,w=void 0!==d.support.checkOn?!d.support.checkOn:d.browser.safari;u();!0===a.draggable&&v();y();p()}}}})(jQuery);
